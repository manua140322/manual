<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Элемент meta определяет метаданные документа. -->
	<meta charset="utf-8">
	<!-- Мета-теги для адаптивной вёрстки -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Bootstrap CSS-->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<!-- Дополнительный JavaScript; Bootstrap в связке с Popper -->
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
	<!-- jQuery -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<!-- Стили пользователя-->
	<link rel="stylesheet" href="../css/styles.css">
</head>
<body>
	<div class="container" style="padding: 5px" >
		<div class="row justify-content-center">
			<a href="../index.html"><h2>Практические работы</h2></a>			
		</div>
		<div class="row justify-content-center">
			<h3>Практическая работа №3: Создание базы данных на Python</h3>			
		</div>
		<div style="margin-top:25px;">		
			
			<p><b>Цель практической работы:</b>закрепление и расширение знаний, полученных обучающихся при теоретическом изучении предмета, приобретение конкретных практических навыков создания базы данных на Python.</p>
			<p> </p>
			<p><b>Методические указания к выполнению работы:</b></p>
			<p>База данных создается с использованием pgAdmin.</p>
			<p>Для создания и заполнения таблиц можно также использовать язык программирования Python. </p>
			<p># Соединение с базой данных</p>
			<p>CS = psycopg2.connect (user="customer", password="customer", host="127.0.0.1", port="5432", database="price")</p>
			<p># Создание базы данных, заполнение ее начальными данными </p>
			<p>def init_db():</p>
			<p>    try:</p>
			<p>        # Подключение к PostgreSQL</p>
			<p>        conn = CS</p>
			<p>        # Объект cursor, позволяет взаимодействовать с базой данных             </p>
			<p>        cursor = conn.cursor()</p>
			<p>        # Проверка наличия таблицы </p>
			<p>        cursor.execute("SELECT 1 FROM pg_tables WHERE tablename = 'prices'")</p>
			<p>        result = cursor.fetchall()</p>
			<p>        if len(result) > 0:</p>
			<p>            print("Таблица prices уже существует")        </p>
			<p>        else:</p>
			<p>            print("Создается таблица prices")  </p>
			<p>            create_table_query = '''CREATE TABLE public.prices</p>
			<p>            (</p>
			<p>                id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),</p>
			<p>                datep timestamp with time zone NOT NULL,</p>
			<p>                store character varying(128) COLLATE pg_catalog."default" NOT NULL,</p>
			<p>                product character varying(256) COLLATE pg_catalog."default" NOT NULL,</p>
			<p>                cost numeric(6,2) NOT NULL,</p>
			<p>                details text COLLATE pg_catalog."default",</p>
			<p>                CONSTRAINT prices_pkey PRIMARY KEY (id)</p>
			<p>            );'''</p>
			<p>            # Выполнение команды: это создает новую таблицу</p>
			<p>            cursor.execute(create_table_query)</p>
			<p>            # Cохранить изменения</p>
			<p>            conn.commit()</p>
			<p>            print("Таблица prices создана")        </p>
			<p>        # Заполнение таблицы (один раз)</p>
			<p>        sql = "SELECT id FROM prices"</p>
			<p>        # С помощью метода execute объекта cursor можно выполнить запрос в базу данных из Python.</p>
			<p>        # Он принимает SQL-запрос в качестве параметра и возвращает resultSet (строки базы данных):</p>
			<p>        cursor.execute(sql)</p>
			<p>        # Получить результат запроса из resultSet можно с помощью методов, например, fetchAll()</p>
			<p>        row = cursor.fetchone()</p>
			<p>        # Если таблица пустая - заполнить ее</p>
			<p>        if row is None:</p>
			<p>            # Диапазон дат</p>
			<p>            start_dt = DT.strptime('2023-01-01', '%Y-%m-%d')</p>
			<p>            end_dt = DT.strptime('2023-08-31', '%Y-%m-%d')            </p>
			<p>            for i in range(10000):</p>
			<p>                # Счетчик</p>
			<p>                sys.stdout.write("\r" + str(i+1))</p>
			<p>                sys.stdout.flush()</p>
			<p>                # Команда SQL</p>
			<p>                sql = "INSERT INTO public.prices(datep, store, product, cost, details) VALUES ('" + get_random_date(start_dt, end_dt).strftime('%Y-%m-%d') + "', '"+ "Магазин " + str(random.randint(1,10)) + "', '" + "Товар " + str(random.randint(1,1000)) + "'," + str(random.randint(1,1000)) + ", '');"</p>
			<p>                # Выполнить запрос</p>
			<p>                cursor.execute(sql)</p>
			<p>            # Cохранить изменения</p>
			<p>            conn.commit()</p>
			<p>            print("\nТаблица prices заполнена")       </p>
			<p>        # Закрыть объект cursor после завершения работы.</p>
			<p>        cursor.close()</p>
			<p>        # Закрыть соединение после завершения работы.</p>
			<p>        conn.close()</p>
			<p>    except Exception as error:</p>
			<p>        print(error)</p>
			<p>##### Главная программа #####</p>
			<p>def main():</p>
			<p>    # Инициализация таблиц базы данных </p>
			<p>    init_db()</p>
			<p><img width=570 id="Рисунок 72" src="image001.jpg"></p>
			<p>При выполнении данной программы, произойдет создание таблицы и заполнение ее данными. Для этого в командной строке необходимо выполнить команду</p>
			<p>python main.py</p>
			<p><img height=185 id="Рисунок 73" src="image002.jpg"></p>
			<p>База данных готова к работе.</p>
			<p>Задание:</p>
			<p>Создать базу данных согласно варианту базы данных на Python.</p>
			<p>1. Создание БД "Страховая компания". </p>
			<p>Таблицы:</p>
			<p>- Вид страхования (код, наименование).</p>
			<p>- Контракты (номер, дата, сумма, тарифная ставка, код филиала, код вида страхования).</p>
			<p>- Филиал (код филиала, наименование, телефон, адрес).</p>
			<p>2. Создание БД "Гостиница".</p>
			<p>Таблицы:</p>
			<p>- Клиенты (код клиента, фамилия, имя, отчество, паспортная информация).</p>
			<p>- Номера (код, номер, количество человек, цена, комфорт).</p>
			<p>- Размещение (код размещения, код клиента, код комнаты, дата размещения, дата выезда).</p>
			<p>3. Создание БД "Ломбард".</p>
			<p>Таблицы:</p>
			<p>- Клиенты (код клиента, имя, фамилия, отчество, удостоверение личности, срок выдачи документа).</p>
			<p>- Категория товара (код, наименование категории товара).</p>
			<p>- Реализация в ломбард (код, код товарной категории, код клиента, описание товара, срок реализации, срок возврата, сумма, комиссионная плата).</p>
			<p>4. Создание БД "Агентство по трудоустройству".</p>
			<p>Таблицы:</p>
			<p>- Работодатель (код работодателя, наименование, вид деятельности, телефон, адрес).</p>
			<p>- Договора (код соискателя, код работодателя, вид деятельности, комиссионная плата).</p>
			<p>- Соискатели (код соискателя, фамилия, имя, отчество, квалификация, вид деятельности, другие сведения, сумма оплаты труда).</p>
			<p>5. Создание БД "Распределение учебной нагрузки». </p>
			<p>Таблицы:</p>
			<p>- Преподаватели (код преподавателя, фамилия, имя, отчество, должность, ученая степень, стаж работы).</p>
			<p>- Дисциплины (код, наименование дисциплины, количество часов).</p>
			<p>- Нагрузка (код преподавателя, код дисциплины, номер группы).</p>
			<p>6. Создание БД "Грузоперевозки".</p>
			<p>Таблицы:</p>
			<p>- Направления (код маршрута, название, оплата труда, расстояние).</p>
			<p>- Водители (код водителя, фамилия, имя, отчество, стаж работы).</p>
			<p>- Проделанная работа (код маршрута, код водителя, дата отправления, дата возвращения).</p>
			<p>7. Создание БД «Прокат автомобилей». </p>
			<p>Таблицы:</p>
			<p>- Автомобили (код автомобиля, марка, цена, цена аренды, тип).</p>
			<p>- Клиенты (код клиента, фамилия, имя, отчество, телефон, адрес).</p>
			<p>- Выданные автомобили (код автомобиля, код клиента, дата выдачи, дата возврата).</p>
			<p>8. Создание БД "Интернет-магазин".</p>
			<p>Таблицы:</p>
			<p>- Товары (код товара, наименование, цена, единица измерения).</p>
			<p>- Клиенты (код клиента, фамилия, имя, отчество, телефон, адрес, e-mail, постоянный потребитель).</p>
			<p>- Продажа (код продажи, код товара, код клиента, количество, дата продажи, дата доставки).</p>
			<p>9. Создание БД "Ювелирная мастерская".</p>
			<p>Таблицы:</p>
			<p>- Ювелирное изделие (код ювелирного изделия, наименование, вид, код материала, вес, цена).</p>
			<p>- Материалы (код материала, наименование, цена за грамм).</p>
			<p> </p>
			<p><b>Контрольные вопросы:</b></p>
			<p>1. Объект, позволяющий взаимодействовать с базой данных</p>
			<p>2. Команда создания таблицы</p>
			<p>3. Метод, выполняющий запрос в базу данных из Python</p>
		
		</div>
		<div align="center">
			<a style="align:center" href="javascript:history.back();">Назад</a>	
			<a>|</a>
			<a style="align:center" href="javascript:scroll(0,0)">Наверх</a>	
		</div>				
	</div>	<!-- /container -->
</body>
</html>